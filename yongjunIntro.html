<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>helloSpring</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- font awesome 라이브러리 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- DatePicker 라이브러리 원본-->
    <!-- <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker3.min.css"
        integrity="sha512-bal93CVJk2672322Y/W51vS6n6N5g3z3+sT+90I+hWn0V+wN5p9bXp5Q6N6V6b7V7f0Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer" /> -->
    <!-- 데이터 삭제기능 원활히 위해 integrity 속성과 crossorigin 제거 -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker3.min.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Asta+Sans:wght@300..800&display=swap');

        * {
            font-family: "Asta Sans", sans-serif;
        }

        .mypostingbox {
            width: 340px;
            /* background-color: green; */
            margin: 20px auto 20px auto;

            border: 1px solid white;
            border-radius: 5px;
        }

        #postingbtn {
            border: 1px solid black;
            border-radius: 5px;
        }

        .guestbook-header,
        .guestbook-footer {
            display: flex;
            align-items: center;
            /* 세로 중앙 정렬 */
            justify-content: space-between;
            /* 제목은 왼쪽, 버튼은 오른쪽 */
            padding: 5px 0;
            /* 위아래 약간의 여백*/
        }


        #savebtn,
        .updatebtn,
        .deletebtn {
            border: 1px solid black;
            border-radius: 5px;
        }

        .btn-box {
            text-align: right;
        }

        #bootCampGoal {
            border: 1px solid black;
            border-radius: 5px;
        }

        /* .bg-transparent {
            border: 1px solid black;
        } */

        .card {
            margin-top: 20px;
        }

        .btnList {
            margin: 0px 5px 2px 0px;
        }
    </style>
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { doc, deleteDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";


        // 개인 firebase 구성
        const firebaseConfig = {
            apiKey: "AIzaSyBTCbhwGI_6X_Ju-oyGl4Bhyn7FKoOFydA",
            authDomain: "sparta-ba2fd.firebaseapp.com",
            projectId: "sparta-ba2fd",
            storageBucket: "sparta-ba2fd.firebasestorage.app",
            messagingSenderId: "146412911825",
            appId: "1:146412911825:web:e197e28c23646c947099f0",
            measurementId: "G-041ZRM7B0T"
        };


        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 데이터 넣기
        $("#postingbtn").click(async function () {
            let name = $('#name').val();
            let title = $('#title').val();
            let comment = $('#comment').val();
            let date = $('#date').val();

            let doc = {
                'name': name,
                'title': title,
                'comment': comment,
                'date': date,
            };

            // 데이터 넣기 코드
            await addDoc(collection(db, "guestBooks"), doc);
            alert('저장완료!');
            window.location.reload(); // 새로 고침
        })

        // 데이터 가져오기
        let docs = await getDocs(collection(db, "guestBooks"));
        docs.forEach((doc) => {
            let row = doc.data();
            // firebase 문서 ID를 가져오기.
            let docId = doc.id;
            console.log(docId);

            let name = row['name'];
            let title = row['title'];
            let comment = row['comment'];
            let date = row['date'];

            let temp_html = `
            <li data-doc-id="${docId}">
                <div class="card border-dark mb-3" style="max-width: 18rem;">
                    <div class="card-header bg-transparent border-dark">작성자 : ${name}</div>
                    <div class="card-body text-dark">
                        <h5 class="card-title">${title}</h5>
                        <p class="card-text">${comment}</p>
                    </div>
                    <div class="guestbook-footer">
                        <div class="card-footer bg-transparent border-dark">${date}</div>
                        <div class="btnList border-dark">
                            <button type="button" class="btn btn-light deletebtn" data-id="${docId}">삭제</button>
                        </div>
                    </div>
                </div>
                <hr>
            </li>`;

            $('#cardList').append(temp_html);

        });

        // 데이터 수정하기

        // 데이터 삭제하기
        // cardList에 이벤트를 위임하는 방식
        $('#cardList').on('click', '.deletebtn', async function () {

            // 1. 문서 ID 획득
            let docId = $(this).data('id');
            console.log("삭제 시도 ID:", docId); // undefined 대신 실제 ID가 뜨는지 확인

            // 2. 삭제 확인 및 취소 로직
            let isConfirmed = confirm("정말로 이 방명록을 삭제하시겠습니까?");

            // 취소하면 리턴
            if (!isConfirmed) {
                return;
            }

            // 3. Firestore 문서 참조 및 deleteDoc 실행
            // ** Firebase SDK 라이브러리에서 deleteDoc를 가져와야만 한다.**
            await deleteDoc(doc(db, "guestBooks", docId));

            alert("삭제 완료!");

            // 4. 화면에서 해당 카드 제거
            $(this).closest('li').remove();
            window.location.reload();

        });

        // 최초 작성 방명록
        $("#savebtn").click(async function () {
            $('#postingbox').toggle();
        })


        // ID가 datepicker-container인 요소를 datepicker로 초기화
        $('#datepicker-container').datepicker({
            format: 'yyyy-mm-dd', // 날짜 형식 설정
            autoclose: true,      // 날짜 선택 시 자동으로 닫기
            todayHighlight: true, // 오늘 날짜 강조 표시
            language: 'ko'
        });

    </script>
</head>

<body>
    <!-- DatePicker script -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.ko.min.js"></script>
    <!-- <nav class="navigator">
        <h5 class="site-name">
            <a class="nav-menu" href="introduce.html">
                << </a>
        </h5>
        <ul>
            <li><a class="nav-menu" href="introduce.html">꒰১♥໒꒱</a></li>

        </ul>
    </nav> -->
    <div class="container">
        <header class="border-bottom lh-1 py-3">
            <div class="row flex-nowrap justify-content-between align-items-center">
                <div class="col-4 pt-1"> 
                    <a class="link-secondary" href="index.html"> <<<< </a> 
                </div>
                <div class="col-4 text-center mainText" style="font-family: 'Black Han Sans', sans-serif; "> 
                    <h2>미니 프로젝트 - 자기소개</h2>
                </div>
                <div class="col-4 d-flex justify-content-end align-items-center"> <a class="link-secondary" href="#"
                        aria-label="Search"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
                            stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            class="mx-3" role="img" viewBox="0 0 24 24">
                            <title>Search</title>
                            <circle cx="10.5" cy="10.5" r="7.5"></circle>
                            <path d="M21 21l-5.2-5.2"></path>
                        </svg> </a> <a class="btn btn-sm btn-outline-secondary" href="yongjunIntro.html">Sign up</a> </div>
            </div>
        </header>
    </div>
    <main class="container">
        <!-- <div class="card text-bg-dark">
            <img src="..." class="card-img" alt="...">
            <div class="card-img-overlay">
                <h5 class="card-title">Card title</h5>
                <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional
                    content. This content is a little bit longer.</p>
                <p class="card-text"><small>Last updated 3 mins ago</small></p>
            </div>
        </div> -->
        <div class="row mb-1">
            <div class="col-md-12">
                <div
                    class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                    <div class="col p-4 d-flex flex-column position-static">
                        <strong class="d-inline-block mb-2 text-primary-emphasis">7조 팀장</strong>
                        <h3 class="mb-0">정용준</h3>
                        <p class="card-text mb-auto"></p>
                        <h4 class="card-text mb-auto"> [ 관리를 잘합니다! ]</h4>
                        <h4 class="card-text mb-auto"> [ 상담을 잘합니다! ]</h4>
                    </div>
                    <div class="col-auto d-none d-lg-block">
                        <svg aria-label="Placeholder: Thumbnail" class="bd-placeholder-img" height="300"
                            preserveAspectRatio="xMidYMid slice" role="img" width="800"
                            xmlns="http://www.w3.org/2000/svg">
                            <!-- <rect width="100%" height="100%"></rect> -->
                            <image href="https://www.civicnews.com/news/photo/201708/9024_14320_247.jpg" x="0" y="0"
                                width="400" height="300" />
                            <image
                                href="https://mblogthumb-phinf.pstatic.net/20160714_284/sunguru_1468426720899Uf5Ul_JPEG/12074576183_4bce16de6c_k.jpg?type=w420"
                                x="400" y="0" width="400" height="300" />
                        </svg>
                    </div>
                </div>
            </div>
        </div>
        <div class="row g-5">
            <div class="col-md-8">
                <h3 class="pb-4 mb-4 fst-italic border-bottom">
                    자기소개를 시작하며..
                </h3>
                <article class="blog-post">
                    <h2 class="display-5 link-body-emphasis mb-1"></h2>
                    <h4>안녕하세요. [내일배움캠프] KOTLIN 9기 7조 팀장을 맡은 정용준이라고 합니다.</h4>
                    <hr>
                    <h2>프로필</h2>
                    <blockquote class="blockquote">
                        <!-- <li>1993년생</li> -->
                        <li>전북대학교 IT응용시스템공학과</li>
                        <li>콜센터 근무 [2년] : NS홈쇼핑 , 카카오택시</li>
                        <h5>카카오택시 콜센터의 경우 (선임까지 근무)</h5>
                        <li>서버 엔지니어 근무 [1년] : 퓨렌스 (콜센터 녹취 서버 설치 및 운영유지보수)</li>
                    </blockquote>
                    <hr>
                    <h3>MBTI</h3>
                    <blockquote class="blockquote">
                        <li>MBTI : INFP</li>
                        <p>매년 검사할때마다 NF는 고정인데, 각각 I 와 E, J 와 P가 50:50 비율 엇비슷하게 나와서 그때그때 다릅니다!</p>
                    </blockquote>
                    <hr>
                    <h3>나만의 장점</h3>
                    <blockquote class="blockquote">
                        <li>인적 관리를 잘합니다!</li>
                        <p>카카오 택시 콜센터 근무를 1년 6개월 정도 근무했습니다. 근무 특성상 택시 이용하는 고객님 뿐만 아니라 운전하는 기사님들 상담도 병행하였습니다.</p>
                        <p>그러하여 다양한 연령대의 상담을 하였으며, 또한, 선임 직책을 맡았을때 1차 상담사의 진행 어려움이 있을때 상담을 이어받아 케어도 진행했습니다.</p>
                        <li>상담을 잘합니다!</li>
                        <p>더불어서, 팀장님 휴무나 병가로 부재시 상담사들의 업무적인 질문도 받아서 상담을 잘 할수 있도록 이끌어주었습니다. 이 점을 말미삼사 인적 및 스케줄 관리는 잘할 수
                            있다고 자신합니다!</p>
                        <p>또한 업무적인 것 뿐만 아니라, 여타 고민이 있거나 말씀하시고 있으시면 언제든 말씀해주세요! 귀 기울여 듣고</p>
                    </blockquote>
                    <hr>
                    <!-- <p>This is some additional paragraph placeholder content. It's a slightly shorter version of the
                        other
                        highly repetitive body text used throughout. This is an example unordered list:</p>
                    <ul>
                        <li>First list item</li>
                        <li>Second list item with a longer description</li>
                        <li>Third list item to close it out</li>
                    </ul>
                    <p>And this is an ordered list:</p>
                    <ol>
                        <li>First list item</li>
                        <li>Second list item with a longer description</li>
                        <li>Third list item to close it out</li>
                    </ol> -->
                    <!-- <h2>Inline HTML elements</h2>
                    <p>HTML defines a long list of available inline tags, a complete list of which can be found on the
                        <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element">Mozilla Developer
                            Network</a>.
                    </p>
                    <ul>
                        <li><strong>To bold text</strong>, use <code
                                class="language-plaintext highlighter-rouge">&lt;strong&gt;</code>.</li>
                        <li><em>To italicize text</em>, use <code
                                class="language-plaintext highlighter-rouge">&lt;em&gt;</code>.</li>
                        <li>Abbreviations, like <abbr title="HyperText Markup Language">HTML</abbr> should use <code
                                class="language-plaintext highlighter-rouge">&lt;abbr&gt;</code>, with an optional <code
                                class="language-plaintext highlighter-rouge">title</code> attribute for the full phrase.
                        </li>
                        <li>Citations, like <cite>— Mark Otto</cite>, should use <code
                                class="language-plaintext highlighter-rouge">&lt;cite&gt;</code>.</li>
                        <li><del>Deleted</del> text should use <code
                                class="language-plaintext highlighter-rouge">&lt;del&gt;</code> and <ins>inserted</ins>
                            text
                            should use <code class="language-plaintext highlighter-rouge">&lt;ins&gt;</code>.</li>
                        <li>Superscript <sup>text</sup> uses <code
                                class="language-plaintext highlighter-rouge">&lt;sup&gt;</code> and subscript
                            <sub>text</sub> uses <code class="language-plaintext highlighter-rouge">&lt;sub&gt;</code>.
                        </li>
                    </ul>
                    <p>Most of these elements are styled by browsers with few modifications on our part.</p> -->
                    <h2>앞으로 부트캠프 임하고자 하는 각오</h2>
                    <blockquote class="blockquote">
                        <p>늦깎이 부트캠프를 임하게 되서, 부족하지만 열심히 해보겠습니다! 다들 12시간 공부 어렵겠지만 잘해봅시다!</p>
                        <p>대학 다닐때나 서버 엔지니어 할때, 잠깐씩 코딩하는 정도로 어깨넘어 배운거라 많이 부족합니다. 잘 부탁드립니다!</p>
                    </blockquote>
                    <hr>
                    <h3>활용 스킬</h3>
                    <!-- <p>This is some additional paragraph placeholder content. It's a slightly shorter version of the
                        other
                        highly repetitive body text used throughout.</p> -->
                    <dl>
                        <dt>HyperText Markup Language (HTML)</dt>
                        <dt>Cascading Style Sheets (CSS)</dt>
                        <dt>JavaScript (JS)</dt>
                        <dt>Firebase</dt>
                    </dl>
                    <hr>
                </article>
                <!-- <article class="blog-post">
                    <h2 class="display-5 link-body-emphasis mb-1">Another blog post</h2>
                    <p class="blog-post-meta">December 23, 2020 by <a href="#">Jacob</a></p>
                    <p>This is some additional paragraph placeholder content. It has been written to fill the available
                        space and show how a longer snippet of text affects the surrounding content. We'll repeat it
                        often
                        to keep the demonstration flowing, so be on the lookout for this exact same string of text.</p>
                    <blockquote>
                        <p>Longer quote goes here, maybe with some <strong>emphasized text</strong> in the middle of it.
                        </p>
                    </blockquote>
                    <p>This is some additional paragraph placeholder content. It has been written to fill the available
                        space and show how a longer snippet of text affects the surrounding content. We'll repeat it
                        often
                        to keep the demonstration flowing, so be on the lookout for this exact same string of text.</p>
                    <h3>Example table</h3>
                    <p>And don't forget about tables in these posts:</p>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Upvotes</th>
                                <th>Downvotes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Alice</td>
                                <td>10</td>
                                <td>11</td>
                            </tr>
                            <tr>
                                <td>Bob</td>
                                <td>4</td>
                                <td>3</td>
                            </tr>
                            <tr>
                                <td>Charlie</td>
                                <td>7</td>
                                <td>9</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td>Totals</td>
                                <td>21</td>
                                <td>23</td>
                            </tr>
                        </tfoot>
                    </table>
                    <p>This is some additional paragraph placeholder content. It's a slightly shorter version of the
                        other
                        highly repetitive body text used throughout.</p>
                </article> -->
                <!-- <article class="blog-post">
                    <h2 class="display-5 link-body-emphasis mb-1">New feature</h2>
                    <p class="blog-post-meta">December 14, 2020 by <a href="#">Chris</a></p>
                    <p>This is some additional paragraph placeholder content. It has been written to fill the available
                        space and show how a longer snippet of text affects the surrounding content. We'll repeat it
                        often
                        to keep the demonstration flowing, so be on the lookout for this exact same string of text.</p>
                    <ul>
                        <li>First list item</li>
                        <li>Second list item with a longer description</li>
                        <li>Third list item to close it out</li>
                    </ul>
                    <p>This is some additional paragraph placeholder content. It's a slightly shorter version of the
                        other
                        highly repetitive body text used throughout.</p>
                </article> -->
                <nav class="blog-pagination" aria-label="Pagination"> <a class="btn btn-outline-primary rounded-pill"
                        href="https://ordism.tistory.com/">내 블로그 주소</a> <a
                        class="btn btn-outline-dark rounded-pill disabled" aria-disabled="true">☞☞☞ 자기소개 페이지 방문해주셨다면 오른쪽
                        방명록 작성 부탁드립니다! ☞☞☞</a> </nav>
                <hr>
            </div>
            <div class="col-md-4">
                <div class="position-sticky" style="top: 2rem;">
                    <div id="bootCampGoal" class="p-4 mb-3 bg-body-tertiary rounded">
                        <h4 class="fst-italic">★부트캠프 목표★</h4>
                        <p class="mb-0">머리속에 떠오르는 페이지 기획을</p>
                        <p class="mb-0">구글링을 많이 하지 않더라도 </p>
                        <p class="mb-0">바로 코드로 구현해보자!</p>
                    </div>
                    <div>
                        <div class="guestbook-header">
                            <h4 class="fst-italic">방명록</h4>
                            <button id="savebtn" type="button" class="btn btn-light">방명록 작성</button>
                        </div>
                        <!-- 최초 작성 방명록 -->
                        <div class="mypostingbox p-2 mb-2 bg-body-tertiary rounded" id="postingbox"
                            style="display:none;">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="name" placeholder="방문자 이름">
                                <label for="floatingInput">방문자 이름</label>
                            </div>
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="title" placeholder="방명록 제목">
                                <label for="floatingInput">방명록 제목</label>
                            </div>
                            <!-- <div class="input-group mb-3"> -->
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="comment" placeholder="방명록 내용">
                                <label for="floatingInput">방명록 내용</label>
                            </div>
                            <div class="form-floating mb-3">
                                <div class="input-group date" id="datepicker-container">
                                    <input type="text" class="form-control" id="date" placeholder="작성 날짜">
                                    <span class="input-group-append">
                                        <button class="btn btn-outline-secondary" type="button">
                                            <i class="fas fa-calendar-alt"></i>
                                        </button>
                                    </span>
                                </div>
                            </div>
                            <div class="btn-box">
                                <button id="postingbtn" type="button" class="btn btn-light">기록하기</button>
                            </div>
                            <hr>
                        </div>
                        <ul id="cardList" class="list-unstyled">
                            <!-- <li>
                                <div class="card border-dark mb-3" style="max-width: 18rem;">
                                    <div class="card-header bg-transparent border-dark">작성자 : Header</div>
                                    <div class="card-body text-dark">
                                        <h5 class="card-title">Success card title</h5>
                                        <p class="card-text">Some quick example text to build on the card title and make
                                            up the bulk of the card's content.</p>
                                    </div>
                                    <div class="guestbook-footer">
                                        <div class="card-footer bg-transparent border-dark">Footer</div>
                                        <div class="btnList border-dark">
                                            <button id="updatebtn" type="button" class="btn btn-light">수정</button>
                                            <button id="deletebtn" type="button" class="btn btn-light">삭제</button>
                                        </div>
                                    </div>
                                </div>
                            </li> -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="py-5 text-center text-body-secondary bg-body-tertiary">
        <p>CopyRight@ [내일배움캠프] KOTLIN 9기 _ 7조 helloSpring</p>
        <p class="mb-0"> Thanks to Sparta </p>
    </footer>

</body>

</html>